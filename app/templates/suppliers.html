{% extends 'base.html' %}
{% block content %}
<div class="row g-3">
  <div class="col-md-4">
    <div class="card shadow-sm">
      <div class="card-header bg-success text-white">â• Ø¥Ø¶Ø§ÙØ© ØªØ§Ø¬Ø± Ø¬Ø¯ÙŠØ¯</div>
      <div class="card-body">
        <form method="post">
          <div class="mb-2">
            <label class="form-label">Ø§Ø³Ù… Ø§Ù„ØªØ§Ø¬Ø±</label>
            <input class="form-control" name="name" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Ù‡Ø§ØªÙ</label>
            <input class="form-control" name="phone">
          </div>
          <button class="btn btn-success w-100">Ø­ÙØ¸</button>
        </form>
      </div>
    </div>
  </div>
  <div class="col-md-8">
    <div class="card shadow-sm">
      <div class="card-header bg-light">ğŸ¤ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ¬Ø§Ø±</div>
      <div class="card-body p-0">
        <table class="table table-striped mb-0 align-middle">
          <thead class="table-light">
            <tr>
              <th>#</th><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ù‡Ø§ØªÙ</th><th>Ø§Ù„Ø±ØµÙŠØ¯</th><th class="text-center" style="width:140px">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
            </tr>
          </thead>
          <tbody>
            {% for s in suppliers %}
            <tr>
              <td>{{ s.id }}</td>
              <td>{{ s.name }}</td>
              <td>{{ s.phone or '-' }}</td>
              <td>{{ '%.2f'|format(s.balance or 0) }} Ø¬.Ù…</td>
              <td class="text-center">
                <button class="btn btn-outline-primary btn-sm edit-supplier" data-id="{{ s.id }}" data-name="{{ s.name }}" data-phone="{{ s.phone or '' }}">ØªØ¹Ø¯ÙŠÙ„</button>
                <form class="d-inline" method="post" action="{{ url_for('main.supplier_delete', sid=s.id) }}" onsubmit="return confirm('Ø­Ø°Ù Ø§Ù„ØªØ§Ø¬Ø±ØŸ');">
                  <button class="btn btn-outline-danger btn-sm">Ø­Ø°Ù</button>
                </form>
              </td>
            </tr>
            {% else %}
            <tr><td colspan="5" class="text-center p-3">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ¬Ø§Ø± Ø¨Ø¹Ø¯</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- Modal ØªØ¹Ø¯ÙŠÙ„ ØªØ§Ø¬Ø± -->
<div class="modal fade" id="editSupplierModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">ØªØ¹Ø¯ÙŠÙ„ ØªØ§Ø¬Ø±</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <form method="post" id="edit-supplier-form">
        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label">Ø§Ø³Ù… Ø§Ù„ØªØ§Ø¬Ø±</label>
            <input class="form-control" name="name" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Ù‡Ø§ØªÙ</label>
            <input class="form-control" name="phone">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
          <button class="btn btn-primary" type="submit">Ø­ÙØ¸</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
document.querySelectorAll('.edit-supplier').forEach(btn => {
  btn.addEventListener('click', () => {
    const form = document.getElementById('edit-supplier-form');
    form.action = `/suppliers/${btn.dataset.id}/update`;
    form.name.value = btn.dataset.name;
    form.phone.value = btn.dataset.phone;
    const modal = new bootstrap.Modal(document.getElementById('editSupplierModal'));
    modal.show();
  });
});
</script>
{% endblock %}
